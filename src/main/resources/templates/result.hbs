<!DOCTYPE html>
<html class="wide wow-animation" lang="ko">
<head>
    <title>MOS</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="icon" href="/images/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Poppins:300,400,500,600,700%7CLato%7CKalam:300,400,700">
    <link rel="stylesheet" href="/css/bootstrap.css">
    <link rel="stylesheet" href="/css/fonts.css">
    <link rel="stylesheet" href="/css/style.css">
    <style>.ie-panel{display: none;background: #212121;padding: 10px 0;box-shadow: 3px 3px 5px 0 rgba(0,0,0,.3);clear: both;text-align:center;position: relative;z-index: 1;} html.ie-10 .ie-panel, html.lt-ie-10 .ie-panel {display: block;}</style>
</head>
<body>
<div class="ie-panel"><a href="http://windows.microsoft.com/en-US/internet-explorer/"><img src="/images/ie8-panel/warning_bar_0000_us.jpg" height="42" width="820" alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today."></a></div>
<div class="preloader">
    <div class="preloader-body">
        <div class="cssload-bell">
            <div class="cssload-circle">
                <div class="cssload-inner"></div>
            </div>
            <div class="cssload-circle">
                <div class="cssload-inner"></div>
            </div>
            <div class="cssload-circle">
                <div class="cssload-inner"></div>
            </div>
            <div class="cssload-circle">
                <div class="cssload-inner"></div>
            </div>
            <div class="cssload-circle">
                <div class="cssload-inner"></div>
            </div>
        </div>
    </div>
</div>
<div class="page">
    <!--상단 바 -->
    <header class="section page-header">
        <div class="rd-navbar-wrap">
            <nav class="rd-navbar rd-navbar-creative rd-navbar-creative-2" data-layout="rd-navbar-fixed" data-sm-layout="rd-navbar-fixed" data-md-layout="rd-navbar-fixed" data-md-device-layout="rd-navbar-fixed" data-lg-layout="rd-navbar-static" data-lg-device-layout="rd-navbar-fixed" data-xl-layout="rd-navbar-static" data-xl-device-layout="rd-navbar-static" data-xxl-layout="rd-navbar-static" data-xxl-device-layout="rd-navbar-static" data-lg-stick-up-offset="100px" data-xl-stick-up-offset="112px" data-xxl-stick-up-offset="132px" data-lg-stick-up="true" data-xl-stick-up="true" data-xxl-stick-up="true">
                <div class="rd-navbar-aside-outer" style="background-color: #C5E5F2;">
                    <div class="rd-navbar-aside">
                        <div class="rd-navbar-collapse"></div>
                        <div class="rd-navbar-panel" style="background-color: #C5E5F2;">
                            <div class="rd-navbar-brand">
                                <!--로고 이미지--><a class="brand" href="/order"><img class="brand-logo-dark" src="/images/main_logo.png" alt="" width="117" height="41"/><img class="brand-logo-light" src="/images/main_logo.png" alt="" width="117" height="41"/></a>
                            </div>
                        </div>
                        <div class="rd-navbar-aside-element"></div>
                    </div>
                </div>
            </nav>
        </div>
    </header>
    <!-- 페이지 소개 -->
    <section class="breadcrumbs-custom">
            <div class="breadcrumbs-custom-body parallax-content context-dark">
                <div class="container cart-container" id="title2">
                    <script id="titleTem" type="text/x-handlebars-template">
                    <h2 class="text-transform-capitalize breadcrumbs-custom-title">
                        \{{title2}}
                    </h2>
                    </script>
                </div>
            </div>
    </section>
    <!-- 주문 목록 -->
    <section class="section section-xxl bg-default text-center">
        <div class="container">
            <div class="row row-xl row-30 justify-content-center">
                    <div class="col-sm-6 col-lg-4">
                        <article class="pricing-classic">
                            <div class="pricing-classic-header"><img class="pricing-classic-figure2"  alt="" width="346" height="229"/>
                                <div class="pricing-classic-caption">
                                    <div>
                                        <h3 class="pricing-classic-title">주문번호 {{id}}</h3>
                                        <div class="pricing-classic-price-wrap">
                                            <div class="pricing-classic-price heading-4">{{total}}원</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="pricing-classic-body">
                                <ul class="pricing-classic-list" id="desc">
                                    {{#menus}}
                                        <li><span>{{name}}</span> {{count}}</li>
                                    {{/menus}}
                                </ul>
                                <button class="button button-lg button-secondary2 button-zakaria status" id="status" style="padding-right:10px; padding-left:10px;"></button>
                                <script id="statusTem" type="text/x-handlebars-template">
                                    \{{status}}
                                    </script>
                            </div>
                            <script id="descTem" type="text/x-handlebars-template">
                                <h3>판매자의 요청으로 주문이 취소되었습니다.</h3>
                            </script>
                        </article>
                    </div>
            </div>
        </div>
    </section>
    <footer class="section footer-modern footer-modern-2">
        <div class="footer-modern-panel text-center">
            <div class="container">
                <p class="rights"><span>&copy;&nbsp; </span><span class="copyright-year"></span><span>&nbsp;</span><span>MOS</span><span>.&nbsp; All rights reserved.</span><span>&nbsp;</span><a href="privacy-policy.html">Privacy Policy</a><span>.</span></p>
            </div>
        </div>
    </footer>
</div>
<div class="snackbars" id="form-output-global"></div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/3.0.1/handlebars.js"></script>
<script src="/js/core.min.js"></script>
<script src="/js/script.js"></script>
<script type="text/javascript">

    var source = $("#titleTem").html();
    var titleTem = Handlebars.compile(source);
    source = $("#statusTem").html();
    var statusTem = Handlebars.compile(source);
    var check = 0;

    var data = {
        title2: '주문 내역',
        status: '조리중'
    }

    $('#title2').append(titleTem(data));
    $('#status').append(statusTem(data));


var webSocket = new WebSocket("ws://ec2-15-164-44-102.ap-northeast-2.compute.amazonaws.com:8080//ws");

webSocket.onopen = function(message) {
var mess = "주문 " + {{id}};
webSocket.send(mess);
};
webSocket.onclose = function(message) {

};
webSocket.onerror = function(message) {
    alert("소켓 에러");
};
webSocket.onmessage = function(message) {
    var jbSplit = message.data.split(' ');

    if(jbSplit[0] == "판매자_주문취소"){
        source = $("#descTem").html();
        var descTem = Handlebars.compile(source);
        alert('주문 취소');
        data = {
            title2: '주문 취소',
            status: '주문 취소'
        }
        $('#desc').html(descTem(data));
        $('#title2').children().remove();
        $('#status').children().remove();
        $('#title2').html(titleTem(data));
        $('#status').html(statusTem(data));

        sessionStorage.clear();
    }
    if(jbSplit[0] == "판매자_조리완료"){
        alert('조리 완료');
        data = {
            title2: '조리 완료',
            status: '조리 완료'
        }
        $('#title2').children().remove();
        $('#status').children().remove();
        $('#title2').html(titleTem(data));
        $('#status').html(statusTem(data));

        sessionStorage.clear();
    }
};
function sendMessage(id) {

}
function disconnect() {
    webSocket.close();
}

</script>
</body>
</html>